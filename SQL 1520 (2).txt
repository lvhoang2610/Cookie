SQL: SELECT `main_table`.`auto_id`, `main_table`.`in_out_whse_schedule_no`, `main_table`.`eur_hope_deliv_due_date`, `t_sales_delivery_date_ans_delivery`.`eur_expected_delivery_date`, `main_table`.`psi_crt_no`, `main_table`.`sales_dest_order_no`, `main_table`.`eur_order_no`, `main_table`.`sales_order_no`, `main_table`.`sales_order_dtl_no`, `main_table`.`dtl_no`, `main_table`.`pfi_no`, `main_table`.`glb_parts_no`, `main_table`.`component_gbl_parts_no`, `main_table`.`customer_biz_partner_parts_no`, `main_table`.`in_whse_schedule_quantity`, `main_table`.`customer_jp_parts_nm` AS `customer_parts_nm`, `main_table`.`customer_biz_partner_parts_model`, `main_table`.`parts_type`, (CASE WHEN (main_table.transportation_type = "01" AND m_ttcg_parts.ovs_sea_long_item_flg = 1) OR (main_table.transportation_type = "02" AND m_ttcg_parts.ovs_air_long_item_flg =  1) THEN 1 ELSE 0 END) AS `long_item_flg`, (CASE WHEN (main_table.transportation_type = "01" AND m_ttcg_parts.ovs_sea_heavy_parts_flg = 1) OR (main_table.transportation_type = "02" AND m_ttcg_parts.ovs_air_heavy_parts_flg =  1) THEN 1 ELSE 0 END) AS `overweight_flg`, (CASE WHEN (main_table.transportation_type = "01" AND m_ttcg_parts.ovs_sea_dangerous_parts_flg = 1) OR (main_table.transportation_type = "02" AND m_ttcg_parts.ovs_air_dangerous_parts_flg =  1) THEN 1 ELSE 0 END) AS `dangerous_flg`, (CASE WHEN (main_table.transportation_type = "01" AND m_ttcg_parts.ovs_sea_chemical_parts_flg = 1) OR (main_table.transportation_type = "02" AND m_ttcg_parts.ovs_air_chemical_parts_flg =  1) THEN 1 ELSE 0 END) AS `chemical_flg`, (CASE WHEN (main_table.transportation_type = "01" AND m_ttcg_parts.ovs_sea_battery_flg = 1) OR (main_table.transportation_type = "02" AND m_ttcg_parts.ovs_air_battery_flg =  1) THEN 1 ELSE 0 END) AS `battery_flg`, (CASE WHEN m_ttcg_base_deli_des.jp_base_nm IS NULL OR m_ttcg_base_deli_des.jp_base_nm = "" THEN m_local_biz_partner_deli_des.jp_biz_partner_nm ELSE m_ttcg_base_deli_des.jp_base_nm END) AS `deli_des_biz_partner_nm`, `main_table`.`origin_country_cd`, `main_table`.`in_whse_schedule_date`, `main_table`.`hs_cd`, `t_in_out_whse_schedule_max`.`sts`, `main_table`.`incoterms_cd`, `main_table`.`limit_mng_no`, `main_table`.`shipment_stop_flg`, `main_table`.`in_out_whse_func_section_cd`, `main_table`.`sales_glb_biz_partner_cd`, `main_table`.`own_ttcg_company_cd`, `main_table`.`eur_biz_partner_base_cd`, `m_local_biz_partner_end_user`.`jp_biz_partner_nm` AS `biz_partner_nm`, `m_biz_partner_base_end_user`.`jp_biz_partner_base_nm` AS `biz_partner_base_nm`, `m_biz_partner_base_end_user`.`biz_partner_base_cd` AS `end_user_biz_partner_base_cd`, `m_local_biz_partner_seller`.`jp_biz_partner_nm` AS `seller_biz_partner_nm`, `t_in_whse_result`.`in_whse_result_date`, `m_ttcg_base_deli_des`.`jp_base_nm` AS `des_base_nm`, `m_local_biz_partner_deli_des`.`jp_biz_partner_nm` AS `des_biz_partner_nm`, `m_local_biz_partner_forwarder`.`jp_biz_partner_nm` AS `forwarder_biz_partner_nm`, `m_quantity_unit`.`jp_display_unit_nm` AS `display_unit_nm`, `m_local_biz_partner_end_user`.`glb_biz_partner_cd` AS `end_user_glb_biz_partner_cd`, `m_ttcg_parts`.`ovs_sea_long_item_flg`, `m_ttcg_parts`.`ovs_air_long_item_flg`, `m_ttcg_parts`.`ovs_sea_heavy_parts_flg`, `m_ttcg_parts`.`ovs_air_heavy_parts_flg`, `m_ttcg_parts`.`ovs_sea_dangerous_parts_flg`, `m_ttcg_parts`.`ovs_air_dangerous_parts_flg`, `m_ttcg_parts`.`ovs_sea_chemical_parts_flg`, `m_ttcg_parts`.`ovs_air_chemical_parts_flg`, `m_ttcg_parts`.`ovs_sea_battery_flg`, `m_ttcg_parts`.`ovs_air_battery_flg`, `main_table`.`classification_result_type`, `t_sales_order_dtl`.`separate_exp_license_no`, `t_sales_order_dtl`.`inclusion_exp_license_no`, (CASE WHEN (t_sales_order_dtl.separate_exp_license_no IS NOT NULL  AND t_sales_order_dtl.separate_exp_license_no != "") THEN t_sales_order_dtl.separate_exp_license_no ELSE t_sales_order_dtl.inclusion_exp_license_no END) AS `inclusion_separate_exp_license_no`, (CASE WHEN "edit" = "edit" AND t_psi_crt_header.profitable_chk_approval_type != "02" THEN main_table.hs_cd ELSE m_ttcg_hs_code.hs_cd END) AS `hs_cd` FROM `t_in_out_whse_schedule` AS `main_table`
 INNER JOIN (SELECT in_out_whse_schedule_no,glb_parts_no,MIN(moving_turn) AS moving_turn FROM t_in_out_whse_schedule LEFT JOIN m_biz_partner_base ON
            t_in_out_whse_schedule.own_ttcg_company_cd = m_biz_partner_base.ttcg_company_cd
            AND t_in_out_whse_schedule.out_whse_base_glb_biz_partner_cd = m_biz_partner_base.glb_biz_partner_cd
            AND t_in_out_whse_schedule.out_whse_base_biz_partner_base_cd = m_biz_partner_base.biz_partner_base_cd
            AND m_biz_partner_base.is_deleted = 0
            LEFT JOIN m_ttcg_base ON t_in_out_whse_schedule.own_ttcg_company_cd = m_ttcg_base.ttcg_company_cd
            AND t_in_out_whse_schedule.out_whse_base_ttcg_base_cd = m_ttcg_base.ttcg_base_cd
            AND m_ttcg_base.is_deleted = 0 WHERE ( m_ttcg_base.ttcg_company_cd = 'S005'  AND m_ttcg_base.packing_instr_dest_flg = 1
            AND m_ttcg_base.is_deleted = 0
            AND t_in_out_whse_schedule.out_whse_base_base_type = '10' )  OR ( m_biz_partner_base.ttcg_company_cd = 'S005'  AND m_biz_partner_base.packing_instr_dest_flg = 1
            AND m_biz_partner_base.is_deleted = 0
            AND t_in_out_whse_schedule.out_whse_base_base_type = '20' )AND own_ttcg_company_cd = 'S005' AND logistics_pattern_type = "02"AND (psi_crt_no = "" AND shipment_advisability_sts != "03") GROUP BY in_out_whse_schedule_no,glb_parts_no UNION ALL SELECT tiows.in_out_whse_schedule_no,tiows.glb_parts_no,tiows.moving_turn FROM t_in_out_whse_schedule tiows INNER JOIN t_psi_crt_dtl tpcd ON tiows.in_out_whse_schedule_no = tpcd.in_out_whse_schedule_no AND tiows.dtl_no = tpcd.dtl_no WHERE (tiows.own_ttcg_company_cd = 'S005' AND tiows.shipment_advisability_sts != "03" AND tiows.dtl_no != "" AND (tpcd.psi_dtl_invalid_flg = 1 OR tpcd.sampling_target_flg = 1)AND tpcd.is_deleted = 0 AND tiows.is_deleted = 0) OR(tiows.psi_crt_no = 'lvhoang_no1' AND tpcd.psi_dtl_invalid_flg = 0 AND tpcd.sampling_target_flg = 0 AND tpcd.is_deleted = 0) ) AS `t_in_out_whse_schedule_min` ON t_in_out_whse_schedule_min.in_out_whse_schedule_no = main_table.in_out_whse_schedule_no AND t_in_out_whse_schedule_min.moving_turn = main_table.moving_turn
 LEFT JOIN `t_in_whse_result` ON t_in_whse_result.in_out_whse_schedule_no = main_table.in_out_whse_schedule_no AND t_in_whse_result.dtl_no = main_table.dtl_no AND t_in_whse_result.is_deleted = '0'
 INNER JOIN `m_ttcg_biz_day` ON m_ttcg_biz_day.ttcg_company_cd = 'S005' AND m_ttcg_biz_day.is_deleted = '0'
 INNER JOIN `m_ttcg_division_group` ON m_ttcg_division_group.ttcg_company_cd = main_table.own_ttcg_company_cd AND m_ttcg_division_group.ttcg_section_cd = main_table.in_out_whse_func_section_cd AND m_ttcg_division_group.start_date <= m_ttcg_biz_day.biz_date AND m_ttcg_division_group.end_date >= m_ttcg_biz_day.biz_date AND m_ttcg_division_group.is_deleted = '0'
 INNER JOIN `m_local_biz_partner` AS `m_local_biz_partner_end_user` ON m_local_biz_partner_end_user.ttcg_company_cd = main_table.own_ttcg_company_cd AND m_local_biz_partner_end_user.glb_biz_partner_cd = main_table.eur_glb_biz_partner_cd AND m_local_biz_partner_end_user.is_deleted = '0'
 INNER JOIN `m_biz_partner_base` AS `m_biz_partner_base_end_user` ON m_biz_partner_base_end_user.ttcg_company_cd = main_table.own_ttcg_company_cd AND m_biz_partner_base_end_user.glb_biz_partner_cd = main_table.eur_glb_biz_partner_cd AND m_biz_partner_base_end_user.biz_partner_base_cd = main_table.eur_biz_partner_base_cd AND m_biz_partner_base_end_user.is_deleted = '0'
 INNER JOIN `m_local_biz_partner` AS `m_local_biz_partner_seller` ON m_local_biz_partner_seller.ttcg_company_cd = main_table.own_ttcg_company_cd AND m_local_biz_partner_seller.glb_biz_partner_cd = main_table.sales_glb_biz_partner_cd AND m_local_biz_partner_seller.is_deleted = '0'
 INNER JOIN (SELECT tiows.in_whse_base_base_type,tiows.in_whse_base_ttcg_base_cd,tiows.in_whse_base_glb_biz_partner_cd,tiows.in_out_whse_schedule_no,tiows.own_ttcg_company_cd,tiows.out_whse_base_biz_partner_type,tiows.in_whse_base_biz_partner_type, tiows.sts FROM t_in_out_whse_schedule tiows INNER JOIN (SELECT in_out_whse_schedule_no,own_ttcg_company_cd,MAX(moving_turn) AS moving_turn FROM t_in_out_whse_schedule WHERE is_deleted = 0 AND out_whse_base_biz_partner_type = "02" GROUP BY in_out_whse_schedule_no, own_ttcg_company_cd) AS t_in_out_whse_schedule_mv ON tiows.in_out_whse_schedule_no =t_in_out_whse_schedule_mv.in_out_whse_schedule_no AND tiows.moving_turn= t_in_out_whse_schedule_mv.moving_turn AND tiows.out_whse_base_biz_partner_type = "02" AND tiows.own_ttcg_company_cd=  t_in_out_whse_schedule_mv.own_ttcg_company_cd) AS `t_in_out_whse_schedule_max` ON t_in_out_whse_schedule_max.in_out_whse_schedule_no = main_table.in_out_whse_schedule_no
 LEFT JOIN `m_ttcg_base` AS `m_ttcg_base_deli_des` ON m_ttcg_base_deli_des.ttcg_company_cd = t_in_out_whse_schedule_max.own_ttcg_company_cd AND m_ttcg_base_deli_des.ttcg_base_cd = t_in_out_whse_schedule_max.in_whse_base_ttcg_base_cd AND t_in_out_whse_schedule_max.in_whse_base_base_type = '10' AND m_ttcg_base_deli_des.is_deleted = '0'
 LEFT JOIN `m_local_biz_partner` AS `m_local_biz_partner_deli_des` ON m_local_biz_partner_deli_des.ttcg_company_cd = t_in_out_whse_schedule_max.own_ttcg_company_cd AND m_local_biz_partner_deli_des.glb_biz_partner_cd = t_in_out_whse_schedule_max.in_whse_base_glb_biz_partner_cd AND t_in_out_whse_schedule_max.in_whse_base_biz_partner_type = '20' AND m_local_biz_partner_deli_des.is_deleted = '0'
 INNER JOIN (SELECT tiows.own_ttcg_company_cd,tiows.out_whse_base_biz_partner_type,tiows.out_whse_base_glb_biz_partner_cd,tiows.in_out_whse_schedule_no FROM t_in_out_whse_schedule tiows INNER JOIN (SELECT in_out_whse_schedule_no,own_ttcg_company_cd,MAX(moving_turn) AS moving_turn FROM t_in_out_whse_schedule WHERE is_deleted = 0 AND out_whse_base_biz_partner_type = "04" GROUP BY in_out_whse_schedule_no, own_ttcg_company_cd) AS t_in_out_whse_schedule_mv ON tiows.in_out_whse_schedule_no =t_in_out_whse_schedule_mv.in_out_whse_schedule_no AND tiows.moving_turn= t_in_out_whse_schedule_mv.moving_turn AND tiows.out_whse_base_biz_partner_type = "04" AND  tiows.own_ttcg_company_cd = t_in_out_whse_schedule_mv.own_ttcg_company_cd) AS `t_in_out_whse_schedule_max_forwarder` ON t_in_out_whse_schedule_max_forwarder.in_out_whse_schedule_no = main_table.in_out_whse_schedule_no
 INNER JOIN `m_local_biz_partner` AS `m_local_biz_partner_forwarder` ON m_local_biz_partner_forwarder.ttcg_company_cd = t_in_out_whse_schedule_max_forwarder.own_ttcg_company_cd AND m_local_biz_partner_forwarder.glb_biz_partner_cd = t_in_out_whse_schedule_max_forwarder.out_whse_base_glb_biz_partner_cd AND m_local_biz_partner_forwarder.is_deleted = '0'
 INNER JOIN `m_quantity_unit` ON m_quantity_unit.quantity_unit_cd = main_table.quantity_unit_cd AND m_quantity_unit.is_deleted = '0'
 INNER JOIN `t_sales_order_dtl` ON t_sales_order_dtl.sales_order_no = main_table.sales_order_no AND t_sales_order_dtl.sales_order_dtl_no = main_table.sales_order_dtl_no AND t_sales_order_dtl.is_deleted = '0'
 INNER JOIN `t_sales_delivery_date_ans_delivery` ON t_sales_delivery_date_ans_delivery.sales_order_no = main_table.sales_order_no AND t_sales_delivery_date_ans_delivery.sales_order_dtl_no = main_table.sales_order_dtl_no AND t_sales_delivery_date_ans_delivery.sales_order_delivery_serial_no = main_table.sales_order_delivery_serial_no AND t_sales_delivery_date_ans_delivery.is_deleted = '0'
 INNER JOIN `m_ttcg_parts` ON m_ttcg_parts.ttcg_company_cd = main_table.own_ttcg_company_cd AND m_ttcg_parts.glb_parts_no = main_table.glb_parts_no AND m_ttcg_parts.is_deleted = '0'
 INNER JOIN `m_ttcg_hs_code` ON m_ttcg_hs_code.ttcg_company_cd = main_table.own_ttcg_company_cd AND m_ttcg_hs_code.glb_parts_no = main_table.glb_parts_no AND m_ttcg_hs_code.forwarder_cd = main_table.responsible_forwarder_cd AND m_ttcg_hs_code.logistics_pattern_type = main_table.logistics_pattern_type AND m_ttcg_hs_code.is_deleted = '0'
 LEFT JOIN `t_psi_crt_header` ON t_psi_crt_header.psi_crt_no = main_table.psi_crt_no AND t_psi_crt_header.is_deleted = '0' WHERE ((`m_ttcg_division_group`.`jp_section_name` = '東アジアG')) AND ((`m_local_biz_partner_seller`.`jp_biz_partner_nm` = 'TMMK 北米トヨタ ケンタッキー工場')) AND ((`main_table`.`transportation_type` = '03')) AND ((IFNULL(t_in_whse_result.in_whse_result_date,"") <= '2022-03-04')) AND ((`main_table`.`incoterms_cd` = 'CIF')) LIMIT 50
